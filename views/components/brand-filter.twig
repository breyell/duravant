{% set brands = get_posts({
  post_type: 'brand',
  posts_per_page: -1,
  orderby: 'title',
  order: 'ASC',
}) %}

{% set brands_data = brands|json_encode|escape('html_attr') %}

{% set product_categories = get_terms({
  taxonomy: 'product-category',
  parent: 0,
}) %}

{% set solutions = get_terms({
  taxonomy: 'solution',
  parent: 0,
}) %}

<section
  x-data="brandFilter({{ brands_data }})"
  x-resize="width = $width"
  class="fluid-grid mb-12"
>
  <div class="span-content grid grid-cols-subgrid">
    <div class="col-span-12 lg:col-span-3 mb-8">
      <select
        x-model="selectedItem"
        class="border cursor-pointer w-full h-12 text-body-medium rounded-md pl-5 pr-8 py-3 border-gray-light"
      >
        <option value="">All Brands</option>
        <optgroup label="Solutions">
          {% for solution in solutions %}
            <option value="solution|{{ solution.id }}">{{ solution.title }}</option>
          {% endfor %}
        </optgroup>
        <optgroup label="Product Categories">
          {% for category in product_categories %}
            <option value="category|{{ category.id }}">{{ category.title }}</option>
          {% endfor %}
        </optgroup>
      </select>
    </div>
  </div>
  <ul
    x-auto-animate
    class="span-content grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6 lg:gap-8"
  >
    <template
      x-for="brand in displayedBrands"
      :key="brand.id"
    >
      <li class="relative bg-bone p-2">
        <article class="w-full">
          <div class="w-full bg-white">
            <a
              :href="brand.website"
              target="_blank"
              class="block w-full aspect-video"
            >
              <span class="absolute inset-0"></span>
              <span class="absolute inset-0 border-8 border-blue-dark opacity-0 transition-opacity hover:opacity-100"></span>
              <img
                :src="brand.logo.src"
                :alt="brand.title"
                :srcset="brand.logo.srcset"
                :width="brand.logo.width"
                :height="brand.logo.height"
                class="size-full p-8 object-contain"
                sizes="(min-width: 1376px) 280px, (min-width: 1024px) 25vw, (min-width: 768px) 33vw, (min-width: 640px) 50vw, 100vw"
              >
            </a>
          </div>
          <div class="p-2 mt-2">
            <h3
              x-text="brand.previewHeading"
              class="text-body-large font-bold"
            ></h3>
            <p
              x-text="brand.previewBody"
              class="text-body-medium mt-3"
            ></p>
          </div>
        </article>
      </li>
    </template>
  </ul>
  <div class="span-content">
    {{ include('components/brand-filter/pagination.twig') }}
  </div>
</section>
